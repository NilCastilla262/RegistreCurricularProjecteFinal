/** @OnlyCurrentDoc */

function Competencies() {
  var spreadsheet = SpreadsheetApp.getActive();
  spreadsheet.getRange('A:A').activate();
  spreadsheet.getActiveSheet().deleteColumns(spreadsheet.getActiveRange().getColumn(), spreadsheet.getActiveRange().getNumColumns());
  spreadsheet.getActiveSheet().setFrozenColumns(0);
  spreadsheet.getRange('1:16').activate();
  spreadsheet.getActiveSheet().deleteRows(spreadsheet.getActiveRange().getRow(), spreadsheet.getActiveRange().getNumRows());
  spreadsheet.getRange('I:I').activate();
  spreadsheet.getActiveSheet().setFrozenRows(0);
  spreadsheet.getRange('I:X').activate();
  spreadsheet.getActiveSheet().deleteColumns(spreadsheet.getActiveRange().getColumn(), spreadsheet.getActiveRange().getNumColumns());
  spreadsheet.getRange('D:G').activate();
  spreadsheet.setCurrentCell(spreadsheet.getRange('B1'));
  spreadsheet.getActiveSheet().deleteColumns(spreadsheet.getActiveRange().getColumn(), spreadsheet.getActiveRange().getNumColumns());
  spreadsheet.getRange('3:3').activate();
  spreadsheet.getRange('C:F').activate();
  spreadsheet.getActiveSheet().deleteColumns(spreadsheet.getActiveRange().getColumn(), spreadsheet.getActiveRange().getNumColumns());
  spreadsheet.getActiveSheet().setFrozenRows(0);

  var sheet = spreadsheet.getActiveSheet();
  var finder = sheet.createTextFinder("#REF!");
  var foundCells = finder.findAll();
  var rowsToDelete = [];

  for (var i = 0; i < foundCells.length; i++) {
    rowsToDelete.push(foundCells[i].getRow());
  }

  rowsToDelete = rowsToDelete.filter(function(value, index, self) {
    return self.indexOf(value) === index;
  });

  rowsToDelete.sort(function(a, b) {
    return b - a;
  });

  for (var j = 0; j < rowsToDelete.length; j++) {
    sheet.deleteRow(rowsToDelete[j]);
  }
}
